language: php

sudo: false

services:
  - docker

php:
  - 7.3
  - 7.2

# Build is failing in moment:
# https://docs.travis-ci.com/user/for-beginners/#breaking-the-build

# Travis and docker https://docs.travis-ci.com/user/docker/
# PHP in Travis https://docs.travis-ci.com/user/languages/php/

before_script:
  - mkdir ./var ./var/cache ./var/cache/test ./var/cache/dev ./var/cache/prod
  - chmod 777 -R ./var
  - composer install
  - docker-compose up -d

script:
  - docker container exec travis_app php ./vendor/bin/phpunit

after_success:
  - travis_retry php vendor/bin/php-coveralls